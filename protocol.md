# Протокол

1. **Диалог клиента и сервера.**

  * 1.1. *Чтение файла.*
    * К. - “Чтение файла”, \<name\>
    * С. - “Отправка файла”, \<length\>
    * Или
    * С. - “Ошибка”, \<error description\>
  * 1.2. *Запись файла.*
    * К. - “Запись файла”, \<name\>, \<length\>
    * С. - “Ошибка”, \<Such file already exists\>
    * Или
    * С. - “Подтверждение готовности записи”
    * К. - “Отправка файла”
    * С. - “Файл успешно записан”
    * Или
    * С. - “Ошибка”, \<error description\>
  * 1.3. *Получение списка файлов на сервере.*
    * К. - “Чтение списка файлов”
    * С. - “Отправка списка”, \<length\>

2. **Словарь клиента и сервера.**

  * 2.1. *Словарь клиента:*
    * "Чтение файла", \<name\>
    * "Запись файла", \<name\>, \<length\>
    * "Чтение списка файлов"
  * 2.2. *Словарь сервера:*
    * "Отправка файла", \<length\>
    * "Отправка списка файлов", \<length\>
    * "Ошибка", \<description\>
    * "Успех"

3. **Коды запросов клиента и ответов сервера.**

  * 3.1. *Коды запросов клиента:*
    * "Чтение файла" - 0
    * "Запись файла" - 1
    * "Чтение списка файлов" - 2
  * 3.2. *Коды ответов сервера:*
    * "Ошибка" - 128
    * "Успех" - 129
    * "Отправка файла" - 130
    * "Отправка списка файлов" — 131

4. **Формат запросов клиента и ответов сервера.**

  * 4.1. *Формат и примеры запросов клиента:*
    * *Запись файла.*
    * `|C:1|NL:4|N:n|L:4|`
    * `1, 8, 'd', 'a', 't', 'a', '.', 't', 'x', 't', 123456`
    * *Чтение файла.*
    * `|C:1|NL:4|N:n|`
    * `0, 12, 'd', 'a', 't', 'a', '\_', 'n', 'e', 'w', '.', 't', 'x', 't'`
    * *Чтение списка файлов.*
    * `|C:1|`
    * `2`
  * 4.2. *Формат и примеры ответов сервера:*
    * *Ошибка.*
    * `|C:1|DL:4|D:n|`
    * `128, 24, 'd', 'a', 't', 'a', '.', 't', 'x', 't', ' ', 'a', 'l', 'r', 'e', 'a', 'd', 'y', ' ', 'e', 'x', 'i', 's', 't', 's', '.'`
    * *Успех.*
    * `|C:1|`
    * `129`
    * *Отправка файла.*
    * `|C:1|L:4|`
    * `130, 123456`
    * *Отправка списка файлов.*
    * `|C:1|LSL:4|LS:n|`
    * `131, 21, 'd', 'a', 't', 'a', '.', 't', 'x', 't', ' ', 'd', 'a', 't', 'a', '\_', 'n', 'e', 'w', '.', 't', 'x', 't'`

5. **Обозначения:**
  * C - команда (command)
  * NL - длина названия файла (name length)
  * N - название файла (name)
  * L - длина файла (length)
  * DL - длина описания ошибки (description length)
  * D - описание ошибки (description)
  * LSL - длина списка файлов (list length)
  * LS — список файлов (list)

**Примечание.**

  *Число после двоеточия показывает размер элемента в байтах.*

